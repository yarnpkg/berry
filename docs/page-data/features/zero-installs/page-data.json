{"componentChunkName":"component---src-templates-article-js","path":"/features/zero-installs","webpackCompilationHash":"b2a6693520f319d23fa5","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"path":"/features/constraints","title":"Constraints"}}},{"node":{"frontmatter":{"path":"/features/offline-cache","title":"Offline Cache"}}},{"node":{"frontmatter":{"path":"/features/pnp","title":"Plug'n'Play"}}},{"node":{"frontmatter":{"path":"/features/plugins","title":"Plugins"}}},{"node":{"frontmatter":{"path":"/features/protocols","title":"Protocols"}}},{"node":{"frontmatter":{"path":"/features/workspaces","title":"Workspaces"}}},{"node":{"frontmatter":{"path":"/features/zero-installs","title":"Zero-Installs"}}}]},"markdownRemark":{"html":"<p>While not a feature in itself, the term \"Zero Install\" encompasses a lot of Yarn features tailored around one specific goal - to make your projects as stable and fast as possible by removing the main source of entropy from the equation: Yarn itself.</p>\n<h2 id=\"how-does-yarn-impact-a-projects-stability\"><a href=\"#how-does-yarn-impact-a-projects-stability\" aria-label=\"how does yarn impact a projects stability permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How does Yarn impact a project's stability?</h2>\n<p>Yarn does its best to guarantee that running <code class=\"language-text\">yarn install</code> twice gives the same result in both cases. The main way it does this is through a lockfile, which provides all the information needed to install a project in a reproducible way. But is that really enough?</p>\n<p>While Yarn does its best to guarantee that what works now will always work, there's the off chance that a future release introduces a bug that'll prevent you from installing your project. Or maybe your production machine's environment changes and <code class=\"language-text\">yarn install</code> cannot write in the temporary directory anymore, or the network fails and your packages aren't available, or your credentials rotate and you get authentication issues, or ... so many things can go wrong.</p>\n<p>Finally, note that these challenges are not unique to Yarn - you probably still remember some npm bugs where system files were being removed from production servers. That's what we mean: any code that runs is code that will eventually fail. The only sure way to prevent such issues, now and in the future, is to run the least amount of code possible.</p>\n<h2 id=\"how-to-reach-this-zero-install-state-youre-advocating-for\"><a href=\"#how-to-reach-this-zero-install-state-youre-advocating-for\" aria-label=\"how to reach this zero install state youre advocating for permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to reach this \"zero-install\" state you're advocating for?</h2>\n<p>In order to make a project zero-install, you must be able to use it as soon as you clone it. This is very easy starting from Yarn 2!</p>\n<ul>\n<li>\n<p>The cache folder is by default stored within your project folder (in <code class=\"language-text\">.yarn/cache</code>). Just make sure you add it to your repository (see also, <a href=\"/berry/features/offline-cache\">Offline Cache</a>).</p>\n</li>\n<li>\n<p>When running <code class=\"language-text\">yarn install</code>, Yarn will generate a <code class=\"language-text\">.pnp.js</code> and a <code class=\"language-text\">.yarn/virtuals</code> file. Add them both to your repository (the <code class=\"language-text\">virtuals</code> folder contains a bunch of symlinks used to disambiguate peer dependencies - it might look weird, but it's what allows <code class=\"language-text\">yarn link</code> to work A-OK with peer dependencies).</p>\n</li>\n<li>\n<p>Depending on whether you use install scripts or not (we advise you to disable them if you write Javascript, as most use cases for native packages are better solved by wasm-powered packages anyway) also add the <code class=\"language-text\">.yarn/unplugged</code> and <code class=\"language-text\">.yarn/build-state.yml</code> entries.</p>\n</li>\n</ul>\n<p>And that's it! Push your changes to your repository, checkout a new one somewhere, and check whether running <code class=\"language-text\">yarn start</code> (or whatever other script you'd normally use) works.</p>\n<h2 id=\"security-concerns\"><a href=\"#security-concerns\" aria-label=\"security concerns permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Security concerns</h2>\n<p>Note that, by design, this setup requires that you trust people modifying your repository. In particular, projects accepting PRs from external users will have to be careful that the PRs affecting the package archives are legit (since it would otherwise be possible to a malicious user to send a PR for a new dependency after having altered its archive content). The best way to do this would be to add a CI step (for untrusted PRs only) that removes the cache before running an install:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$&gt; rm -rf $(yarn cache dir)\n$&gt; yarn install</code></pre></div>\n<p>This way Yarn will re-download the package files from whatever their remote location would be, and would report any mismatching checksum.</p>","frontmatter":{"path":"/features/zero-installs","title":"Zero-Installs"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"category":"features"}}}