{"componentChunkName":"component---src-templates-article-js","path":"/advanced/migration","webpackCompilationHash":"19dd319f28b2ae228555","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"path":"/advanced/architecture","title":"Architecture"}}},{"node":{"frontmatter":{"path":"/advanced/contributing","title":"Contributing"}}},{"node":{"frontmatter":{"path":"/advanced/error-codes","title":"Error Codes"}}},{"node":{"frontmatter":{"path":"/advanced/lexicon","title":"Lexicon"}}},{"node":{"frontmatter":{"path":"/advanced/managing-releases","title":"Managing Releases"}}},{"node":{"frontmatter":{"path":"/advanced/migration","title":"Migration"}}},{"node":{"frontmatter":{"path":"/advanced/peer-dependencies","title":"Peer Dependencies"}}},{"node":{"frontmatter":{"path":"/advanced/plugin-tutorial","title":"Plugin Tutorial"}}},{"node":{"frontmatter":{"path":"/advanced/pnpapi","title":"PnP API"}}},{"node":{"frontmatter":{"path":"/advanced/pnpify","title":"PnPify"}}}]},"markdownRemark":{"html":"<p>Yarn v2 is a very different software from the v1. While one of our aim is to make the transition as easy as possible, some behaviors needed to be tweaked. To make things easier we've documented the most common problems that may arise when porting from one project to the other, along with suggestions to keep moving forward.</p>\n<h2 id=\"a-package-is-trying-to-access-another-package-\"><a href=\"#a-package-is-trying-to-access-another-package-\" aria-label=\"a package is trying to access another package  permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">A package is trying to access another package [...]</code></h2>\n<blockquote>\n<p>A package is trying to access another package without the second one being listed as a dependency of the first one</p>\n</blockquote>\n<p>Some packages don't properly list their actual dependencies for a reason or another. Now that we've fully switched to Plug'n'Play and enforce boundaries between the various branches of the dependency tree, this kind of issue will start to become more apparent than it previously was.</p>\n<p>The long term fix is to submit a pull request upstream to add the missing dependency to the package listing. Given that it sometimes might take sometime before they get merged, we also have a more short-term fix available: open your <code class=\"language-text\">yarn.lock</code> file, locate the entry for the faulty package, manually add a new <code class=\"language-text\">dependencies</code> entry with the missing dependency, then run <code class=\"language-text\">yarn install</code> to apply your changes.</p>\n<p>Note that the short-term fix isn't meant to be long-term: you'll need to reapply it each time the package version changes and its metadata are downloaded from the registry again. Making the fix upstream is the best way to ensure your workflow won't get disrupted in the future.</p>\n<h2 id=\"yarnrc-files\"><a href=\"#yarnrc-files\" aria-label=\"yarnrc files permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Yarnrc files</h2>\n<p>Yarn 2 uses a different style of configuration files than Yarn 1. While mostly invisible for the lockfile (because we import them on the fly), it might cause some issues for your rc files.</p>\n<ul>\n<li>\n<p>The main change is the name of the file. The v1 uses <code class=\"language-text\">.yarnrc</code>, but starting from the v2 we'll be moving to a different name: <code class=\"language-text\">.yarnrc.yml</code>. This is in part to make it easier to configure both tools at the same time, as they use different syntaxes and configuration keys.</p>\n</li>\n<li>\n<p>As evidenced by the new extension, the Yarnrc files now have to be written in <a href=\"https://en.wikipedia.org/wiki/YAML\">YAML</a>. It's been requested for a long time, and we hope it'll allow easier integrations for the various third-party tools that interact with the Yarnrc files.</p>\n</li>\n<li>\n<p>The configuration keys themselves have changed. You can find the comprehensive list of the supported configuration settings on the <a href=\"/berry/configuration/yarnrc\">dedicated documentation page</a>, but some particular changes you might be interested in:</p>\n<ul>\n<li>\n<p>Custom registries are now configured via <a href=\"/berry/configuration/yarnrc#npmRegistryServer\"><code class=\"language-text\">npmRegistryServer</code></a>.</p>\n</li>\n<li>\n<p>Registry authentication tokens are now configuration via <a href=\"/berry/configuration/yarnrc#npmAuthToken\"><code class=\"language-text\">npmAuthToken</code></a>.</p>\n</li>\n<li>\n<p>The <code class=\"language-text\">yarn-offline-mirror</code> has been removed, since the offline mirror has been merged with the cache as part of the <a href=\"/berry/features/zero-installs\">Zero-Install effort</a>.</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"yarnrc-resolution\"><a href=\"#yarnrc-resolution\" aria-label=\"yarnrc resolution permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Yarnrc resolution</h2>\n<p>On top of their naming, the way we load the Yarnrc files has also been changed and simplified. In particular:</p>\n<ul>\n<li>\n<p>Yarn doesn't use the configuration from your <code class=\"language-text\">.npmrc</code> files anymore; we instead read all of our configuration from the <code class=\"language-text\">.yarnrc.yml</code> files whose available settings can be found in <a href=\"/berry/configuration/yarnrc\">our documentation</a>.</p>\n</li>\n<li>\n<p>As mentioned in the previous section, the yarnrc files are now called <code class=\"language-text\">.yarnrc.yml</code>, with an extension. We've completely stopped reading the values from the regular <code class=\"language-text\">.yarnrc</code> files.</p>\n</li>\n<li>\n<p>All environment variables prefixed with <code class=\"language-text\">YARN_</code> are automatically used to override the matching configuration settings. So for example, adding <code class=\"language-text\">YARN_NPM_REGISTRY_SERVER</code> into your environment will change the value of <a href=\"/berry/configuration/yarnrc#npmRegistryServer\"><code class=\"language-text\">npmRegistryServer</code></a>.</p>\n</li>\n</ul>\n<h2 id=\"yarnrc-settings\"><a href=\"#yarnrc-settings\" aria-label=\"yarnrc settings permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Yarnrc settings</h2>\n<p>The settings available in the yarnrc file have changed. Using old, unsupported settings will cause Yarn to throw an exception at boot time unless properly guarded.</p>\n<p>We recommend you to make sure you only use <a href=\"/berry/configuration/yarnrc\">modern settings</a> if possible. In case a particular feature you relied on in the v1 is missing in the v2, feel free to open an issue on our repository to discuss whether we should add it back.</p>\n<p>If you absolutely need to keep in your file hierarchy both v1 and v2 settings, you can use the special field named <code class=\"language-text\">berry</code>. Should Yarn v2+ find this field, it will use its content and ignore any other field. For example, the following file will work as expected on both the v1 and v2+ releases:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># v1 settings</span>\nworkspaces<span class=\"token punctuation\">-</span>experimental true\n\n<span class=\"token key atrule\">berry</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># v2 settings</span>\n  enable<span class=\"token punctuation\">-</span>global<span class=\"token punctuation\">-</span>cache true</code></pre></div>\n<h2 id=\"plugnplay\"><a href=\"#plugnplay\" aria-label=\"plugnplay permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Plug'n'Play</h2>\n<p>Starting from the v2, Plug'n'Play is enabled by default. This might cause compatibility issues in a few corner cases for projects that kept relying on unsafe patterns. Keep an eye on the <a href=\"/berry/features/pnp\">dedicated page</a>, and try to avoid those projects until they correct the situation. Also feel free to open an issue on Yarn's repository as well so that we can keep track of them and offer our help.</p>\n<h2 id=\"typescript\"><a href=\"#typescript\" aria-label=\"typescript permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TypeScript</h2>\n<p>If you're using TypeScript - and particularly the <code class=\"language-text\">tsc</code> binary - read on the <a href=\"/berry/advanced/pnpify\">PnPify</a> page to learn more about a way to transparently make <code class=\"language-text\">tsc</code> compatible with Plug'n'Play. We actually use it on the Yarn repository itself!</p>","frontmatter":{"path":"/advanced/migration","title":"Migration"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"category":"advanced"}}}